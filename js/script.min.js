var orderLink,closeMessageForm,closeMapForm,userName,userEmail,messageContent,timerId,messageLink=document.querySelector(".message"),mapLink=document.querySelector(".map"),orderLinksList=document.querySelectorAll(".item-buy"),messageForm=document.querySelector(".modal-message"),mapForm=document.querySelector(".modal-map"),orderForm=document.querySelector(".modal-order"),closeOrderForm=orderForm.querySelector(".modal-button-close"),closeOrderFormContinue=orderForm.querySelector(".continue"),isStorageSupport=!0,storageuserName="",storageuserEmail="",storagemessageContent="";try{storageuserName=localStorage.getItem("userName"),storageuserEmail=localStorage.getItem("userEmail"),storagemessageContent=localStorage.getItem("messageContent")}catch(e){isStorageSupport=!1}messageLink&&(closeMessageForm=messageForm.querySelector(".modal-button-close"),userName=messageForm.querySelector("[id=name]"),userEmail=messageForm.querySelector("[id=email]"),messageContent=messageForm.querySelector("[id=content]"),messageLink.addEventListener("click",function(e){e.preventDefault(),messageForm.classList.add("modal-show"),userName.focus()}),closeMessageForm.addEventListener("click",function(e){e.preventDefault(),messageForm.classList.remove("modal-show"),messageForm.classList.remove("modal-error")}),messageForm.addEventListener("submit",function(e){userName.value&&userEmail.value&&""!=messageContent.value?isStorageSupport&&(localStorage.setItem("userName",userName.value),localStorage.setItem("userEmail",userEmail.value)):(e.preventDefault(),console.log("Заполните ваше имя, обратный электронный адрес и текст письма"),messageForm.classList.remove("modal-error"),messageForm.offsetWidth=messageForm.offsetWidth,messageForm.classList.add("modal-error"),userName.value?userEmail.value?""==messageContent.value&&messageContent.focus():userEmail.focus():userName.focus())})),mapLink&&(closeMapForm=mapForm.querySelector(".modal-button-close"),mapLink.addEventListener("click",function(e){e.preventDefault(),mapForm.classList.add("modal-show")}),closeMapForm.addEventListener("click",function(e){e.preventDefault(),mapForm.classList.remove("modal-show")}));for(var i=0;i<orderLinksList.length;i++)(orderLink=orderLinksList[i]).addEventListener("click",function(e){e.preventDefault(),orderForm.classList.add("modal-show"),clearTimeout(timerId),timerId=setTimeout(function(){orderForm.classList.remove("modal-show")},5e3)});closeOrderForm.addEventListener("click",function(e){e.preventDefault(),orderForm.classList.remove("modal-show")}),closeOrderFormContinue.addEventListener("click",function(e){e.preventDefault(),orderForm.classList.remove("modal-show")}),window.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),messageForm&&messageForm.classList.contains("modal-show")&&(messageForm.classList.remove("modal-show"),messageForm.classList.remove("modal-error")),mapForm&&mapForm.classList.contains("modal-show")&&mapForm.classList.remove("modal-show"),orderForm&&orderForm.classList.contains("modal-show")&&orderForm.classList.remove("modal-show"))});